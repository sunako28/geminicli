# .github/workflows/gemini-comment-handler.yml
name: Gemini Comment Handler

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]

jobs:
  handle-gemini-comment:
    # @gemini ã§å§‹ã¾ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿å‡¦ç†
    if: startsWith(github.event.comment.body, '@gemini')
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
      pull-requests: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Process Gemini Comment
        uses: google-gemini/gemini-cli-action@main
        env:
          GH_TOKEN: ${{ github.token }}
        with:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          prompt: |
            ## ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±
            - ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿è€…: ${{ github.event.comment.user.login }}
            - ãƒªãƒã‚¸ãƒˆãƒª: ${{ github.repository }}
            - ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—: ${{ github.event_name }}
            - ã‚³ãƒ¡ãƒ³ãƒˆURL: ${{ github.event.comment.html_url }}
            
            ## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•/ä¾é ¼
            ```
            ${{ github.event.comment.body }}
            ```

            ## å®Ÿè¡ŒæŒ‡ç¤º
            1. GEMINI.mdã‚’ç¢ºèªã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç†è§£
            2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ@geminiä»¥é™ï¼‰ã‚’åˆ†æ
            3. ä»¥ä¸‹ã®ã‚«ãƒ†ã‚´ãƒªã«å¿œã˜ã¦é©åˆ‡ã«å¯¾å¿œï¼š

            ### ğŸ“Š åˆ†æä¾é ¼ã®å ´åˆ
            - ã‚³ãƒ¼ãƒ‰ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†æ
            - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è©•ä¾¡
            - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
            - æ”¹å–„ææ¡ˆã®ç”Ÿæˆ

            ### ğŸ› å•é¡Œè§£æ±ºä¾é ¼ã®å ´åˆ
            - ã‚¨ãƒ©ãƒ¼ã®åŸå› èª¿æŸ»
            - ãƒã‚°ã®ç‰¹å®šã¨ä¿®æ­£æ¡ˆ
            - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ‰‹é †

            ### ğŸ’¡ å®Ÿè£…ææ¡ˆä¾é ¼ã®å ´åˆ
            - æ–°æ©Ÿèƒ½ã®å®Ÿè£…æ–¹æ³•
            - ã‚³ãƒ¼ãƒ‰ä¾‹ã®æä¾›
            - ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®ææ¡ˆ

            ### â“ ä¸€èˆ¬çš„ãªè³ªå•ã®å ´åˆ
            - æŠ€è¡“çš„ãªèª¬æ˜
            - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æƒ…å ±
            - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ¡ˆå†…

            ## å›ç­”ã®å½¢å¼
            - å…·ä½“çš„ã§å®Ÿè£…å¯èƒ½ãªå†…å®¹
            - GEMINI.mdã®åŸºæº–ã«æº–æ‹ 
            - ã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
            - æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚„å‚è€ƒæƒ…å ±

            ## ç‰¹åˆ¥ãªæŒ‡ç¤º
            - ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®å ´åˆã¯ã€å…·ä½“çš„ãªæ”¹å–„ç‚¹ã‚’æ˜ç¤º
            - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã¯æ…é‡ã«å›ç­”
            - ä¸æ˜ãªç‚¹ã¯ç´ ç›´ã«ã€Œåˆ†ã‹ã‚‰ãªã„ã€ã¨å›ç­”
            - é•·ã„å›ç­”ã®å ´åˆã¯è¦ç‚¹ã‚’æœ€åˆã«è¨˜è¼‰

            ã“ã®è¦æ±‚ã«ä»Šã™ãé©åˆ‡ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æŠ•ç¨¿ã—ã¦ãã ã•ã„ã€‚
